{"version":3,"sources":["../../src/polyfill/jsx-custom-event.ts","pages/nextjs11/nextjs11.tsx"],"names":["React","eventLifeCycles","jsxCustomEvent","type","props","children","test","createElement","apply","newProps","Object","assign","ref","element","current","key","toString","call","data","prototype","hasOwnProperty","includes","toLowerCase","eventName","replace","removeEventListener","addEventListener","module","exports","default","Nextjs11","useState","msg","microAppData","changeMicroAppData","name","url","config","nextjs11","ssr","disableScopecss","onCreated","console","log","onBeforemount","onMounted","setTimeout","onUnmount","onError","onDataChange","e","detail"],"mappings":"sGAAA,IAAMA,EAAQ,EAAQ,GAKhBC,EAAkB,CACtB,YACA,gBACA,YACA,YACA,UACA,eACA,eACA,cACA,iBAGF,SAASC,EACPC,EACAC,GACkB,2BAAfC,EAAe,iCAAfA,EAAe,kBAElB,GAAoB,kBAATF,IAAsB,oBAAoBG,KAAKH,KAAUC,EAClE,OAAOJ,EAAMO,cAAcC,MAAM,KAA1B,CAAiCL,EAAMC,GAAvC,OAAiDC,IAG1D,IAAMI,EAAWC,OAAOC,OAAO,GAAIP,GAqCnC,OAlCAK,EAASG,IAAM,SAACC,GAQd,GAPyB,oBAAdT,EAAMQ,IACfR,EAAMQ,IAAIC,GACoB,kBAAdT,EAAMQ,MACrBR,EAAMQ,IAAYE,QAAUD,GAI3BA,EAMF,IAAK,IAAME,IAJuB,oBAA9BC,SAASC,KAAKb,EAAMc,OAA+BL,EAAQK,OAASd,EAAMc,OAC5EL,EAAQK,KAAOd,EAAMc,MAGLd,EAChB,GACEM,OAAOS,UAAUC,eAAeH,KAAKb,EAAOW,IAC5Cd,EAAgBoB,SAASN,EAAIO,gBACP,oBAAflB,EAAMW,MACXF,EAAQE,IAAQF,EAAQE,KAASX,EAAMW,IACzC,CACA,IAAMQ,EAAYR,EAAIO,cAAcE,QAAQ,KAAM,IAC9CX,EAAQE,IAEVF,EAAQY,oBAAoBF,EAAWV,EAAQE,IAAM,GAGvDF,EAAQa,iBAAiBH,EAAWnB,EAAMW,IAAM,GAChDF,EAAQE,GAAOX,EAAMW,KAMtBf,EAAMO,cAAcC,MAAM,KAA1B,CAAiCL,EAAMM,GAAvC,OAAoDJ,IAG7DsB,EAAOC,QAAU1B,EACjByB,EAAOC,QAAQC,QAAU3B,G,mFCXV4B,UAlDE,WACf,MAA2CC,mBAAS,CAACC,IAAK,+CAA1D,mBAAOC,EAAP,KAAqBC,EAArB,KA8BA,OACE,eACE,iBACEC,KAAK,mBACLC,IAAG,UAAKC,IAAOC,SAAZ,8BACHC,KAAG,EACHC,iBAAe,EACftB,KAAMe,EACNQ,UApCN,WACEC,QAAQC,IAAI,mCAoCRC,cAjCN,WACEF,QAAQC,IAAI,+CAiCRE,UA9BN,WACEH,QAAQC,IAAI,oDAEZG,YAAW,WACTZ,EAAmB,CAACF,IAAK,uDACxB,MA0BCe,UAvBN,WACEL,QAAQC,IAAI,mCAuBRK,QApBN,WACEN,QAAQC,IAAI,+CAoBRM,aAjBN,SAA2BC,GACzBR,QAAQC,IAAI,iEAA0BO,EAAEC,OAAOjC","file":"static/js/nextjs11.000ec1eb.chunk.js","sourcesContent":["const React = require('react')\n\ntype MicroElementType = HTMLElement & Record<string, unknown>\n\n// lifecycles\nconst eventLifeCycles = [\n  'oncreated',\n  'onbeforemount',\n  'onmounted',\n  'onunmount',\n  'onerror',\n  'ondatachange',\n  'onbeforeshow',\n  'onaftershow',\n  'onafterhidden',\n]\n\nfunction jsxCustomEvent (\n  type: string | CallableFunction,\n  props: Record<string, unknown> | null,\n  ...children: any[]\n): void {\n  if (typeof type !== 'string' || !/^micro-app(-\\S+)?/.test(type) || !props) {\n    return React.createElement.apply(null, [type, props, ...children])\n  }\n\n  const newProps = Object.assign({}, props)\n\n  // ref will call when create, update, unmount\n  newProps.ref = (element: MicroElementType | null) => {\n    if (typeof props.ref === 'function') {\n      props.ref(element)\n    } else if (typeof props.ref === 'object') {\n      (props.ref as any).current = element\n    }\n\n    // when unmount and update the element is null\n    if (element) {\n      // Update data when the prev and next data are different\n      if (toString.call(props.data) === '[object Object]' && element.data !== props.data) {\n        element.data = props.data\n      }\n\n      for (const key in props) {\n        if (\n          Object.prototype.hasOwnProperty.call(props, key) &&\n          eventLifeCycles.includes(key.toLowerCase()) &&\n          typeof props[key] === 'function' &&\n          (!element[key] || element[key] !== props[key])\n        ) {\n          const eventName = key.toLowerCase().replace('on', '')\n          if (element[key]) {\n            // @ts-ignore\n            element.removeEventListener(eventName, element[key], false)\n          }\n          // @ts-ignore\n          element.addEventListener(eventName, props[key], false)\n          element[key] = props[key]\n        }\n      }\n    }\n  }\n\n  return React.createElement.apply(null, [type, newProps, ...children])\n}\n\nmodule.exports = jsxCustomEvent\nmodule.exports.default = jsxCustomEvent\n","/** @jsxRuntime classic */\n/** @jsx jsxCustomEvent */\nimport jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'\nimport { useState } from 'react'\nimport config from '../../config'\n\nconst Nextjs11 = () => {\n  const [microAppData, changeMicroAppData] = useState({msg: '来自基座的数据'})\n\n  function handleCreate () {\n    console.log('child-nexjs 创建了')\n  }\n\n  function handleBeforeMount () {\n    console.log('child-nexjs 即将被渲染')\n  }\n\n  function handleMount () {\n    console.log('child-nexjs 已经渲染完成')\n\n    setTimeout(() => {\n      changeMicroAppData({msg: '来自基座的新数据'})\n    }, 2000)\n  }\n\n  function handleUnmount () {\n    console.log('child-nexjs 卸载了')\n  }\n\n  function handleError () {\n    console.log('child-nexjs 加载出错了')\n  }\n\n  function handleDataChange (e: CustomEvent) {\n    console.log('来自子应用 child-nexjs 的数据:', e.detail.data)\n  }\n\n  return (\n    <div>\n      <micro-app\n        name='appname-nextjs11'\n        url={`${config.nextjs11}/main-react17/app-nextjs11`}\n        ssr\n        disableScopecss\n        data={microAppData}\n        onCreated={handleCreate}\n        onBeforemount={handleBeforeMount}\n        onMounted={handleMount}\n        onUnmount={handleUnmount}\n        onError={handleError}\n        onDataChange={handleDataChange}\n      ></micro-app>\n    </div>\n  )\n}\n\nexport default Nextjs11\n"],"sourceRoot":""}