{"version":3,"sources":["public-path.ts","assets/logo.svg","pages/home/home.tsx","router.tsx","index.tsx"],"names":["window","__MICRO_APP_ENVIRONMENT__","__webpack_public_path__","__MICRO_APP_PUBLIC_PATH__","Home","className","src","logo","alt","React","version","href","target","rel","Page2","lazy","NavigatorFromBaseApp","history","useHistory","useEffect","microApp","addDataListener","data","path","location","pathname","push","App","id","onClick","e","activePage","getAttribute","setGlobalData","to","exact","fallback","mount","ReactDOM","render","StrictMode","document","getElementById","console","log","getData","setTimeout","dispatch","myname","__MICRO_APP_NAME__","unmount","unmountComponentAtNode"],"mappings":"wGAEIA,OAAOC,4BAETC,IAA0BF,OAAOG,4B,kJCJpB,MAA0B,iC,eCyB1BC,MArBf,WACE,OACE,qBAAKC,UAAU,MAAf,SACE,yBAAQA,UAAU,aAAlB,UACE,qBAAKC,IAAKC,EAAMF,UAAU,WAAWG,IAAI,SACzC,6DACgBC,IAAMC,WAEtB,mBACEL,UAAU,WACVM,KAAK,sBACLC,OAAO,SACPC,IAAI,sBAJN,+BCRFC,EAAQC,gBAAK,kBAAM,gCAGnBC,EAAuB,WAC3B,IAAMC,EAAUC,cAWhB,OATAC,qBAAU,WAAO,IAAD,EACd,UAAAnB,OAAOoB,gBAAP,SAAiBC,iBAAgB,SAACC,GAE5BA,EAAKC,MAAQD,EAAKC,OAASN,EAAQO,SAASC,UAC9CR,EAAQS,KAAKJ,EAAKC,WAGrB,CAACN,IAEG,MAoCMU,MAjCf,WAUE,OAEE,cADA,CACC,IAAD,WACE,sBAAKC,GAAG,eAAeC,QAX3B,SAAwBC,GACtB,GAAI9B,OAAOC,0BAA2B,CACpC,IAAM8B,EAAaD,EAAElB,OAAOoB,aAAa,aAEzChC,OAAOoB,SAASa,cAAc,CAAEF,iBAOhC,UACE,cAAC,IAAD,CAAMG,GAAG,IAAI,YAAU,GAAvB,kBADF,gBAEE,cAAC,IAAD,CAAMA,GAAG,SAAS,YAAU,SAA5B,sBAEF,cAAC,EAAD,IACA,eAAC,IAAD,WACE,cAAC,IAAD,CAAOX,KAAK,IAAIY,OAAK,EAArB,SACE,cAAC,EAAD,MAEF,cAAC,IAAD,CAAOZ,KAAK,SAAZ,SACE,cAAC,WAAD,CAAUa,SAAU,6CAApB,SACE,cAACtB,EAAD,QAGJ,cAAC,IAAD,CAAUoB,GAAG,aCKrB,SAASG,IACPC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,iBAG1BC,QAAQC,IAAI,qDA5CR5C,OAAOC,4BAET0C,QAAQC,IAAI,yBAA0B5C,OAAOoB,SAASyB,WAGtD7C,OAAOoB,SAASC,iBAAgB,SAACC,GAC/BqB,QAAQC,IAAI,iCAAkCtB,MAIhDwB,YAAW,WACT9C,OAAOoB,SAAS2B,SAAS,CAAEC,OAAQ,oBAClC,MA4CHhD,OAAOC,0BAETD,OAAO,aAAD,OAAcA,OAAOiD,qBAAwB,CAAEZ,QAAOa,QAR9D,WACEZ,IAASa,uBAAuBV,SAASC,eAAe,iBACxDC,QAAQC,IAAI,uDASZP,M","file":"static/js/main.fc0b9585.chunk.js","sourcesContent":["/* eslint-disable no-undef */\n// @ts-ignore\nif (window.__MICRO_APP_ENVIRONMENT__) {\n  // @ts-ignore\n  __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__\n}\n","export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React from 'react';\nimport logo from '../../assets/logo.svg';\nimport './home.css';\n\nfunction Home () {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          子应用 -- react@{React.version}\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header>\n    </div>\n  );\n}\n\nexport default Home;\n","import React, { lazy, Suspense, useEffect } from 'react'\nimport { HashRouter, Switch, Route, Redirect, Link, useHistory } from 'react-router-dom'\nimport Home from './pages/home/home'\n\nconst Page2 = lazy(() => import(/* webpackChunkName: \"page2\" */ './pages/page2/page2'))\n\n// 此组件用于监听基座下发的跳转指令\nconst NavigatorFromBaseApp = () => {\n  const history = useHistory()\n\n  useEffect(() => {\n    window.microApp?.addDataListener((data: Record<string, unknown>) => {\n      // 当基座下发path时进行跳转\n      if (data.path && data.path !== history.location.pathname) {\n        history.push(data.path as string)\n      }\n    })\n  }, [history])\n\n  return null\n}\n\nfunction App () {\n  // 子应用内部跳转时，通知侧边栏改变菜单状态\n  function onRouteChange (e: any): void {\n    if (window.__MICRO_APP_ENVIRONMENT__) {\n      const activePage = e.target.getAttribute('page-path')\n      // 发送全局数据，通知侧边栏修改菜单展示\n      window.microApp.setGlobalData({ activePage })\n    }\n  }\n\n  return (\n    // 因为child-react17子应用是hash路由，主应用为history路由，所以不需要设置基础路由__MICRO_APP_BASE_ROUTE__\n    <HashRouter>\n      <div id='public-links' onClick={onRouteChange}>\n        <Link to=\"/\" page-path=''>Home</Link>&ensp;|&ensp;\n        <Link to=\"/page2\" page-path='/page2'>Page2</Link>\n      </div>\n      <NavigatorFromBaseApp />\n      <Switch>\n        <Route path=\"/\" exact>\n          <Home />\n        </Route>\n        <Route path=\"/page2\">\n          <Suspense fallback={<div>Loading...</div>}>\n            <Page2 />\n          </Suspense>\n        </Route>\n        <Redirect to='/' />\n      </Switch>\n    </HashRouter>\n  )\n}\n\nexport default App\n","import './public-path';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Router from './router';\n\ndeclare global {\n  interface Window {\n    microApp: any\n    __MICRO_APP_NAME__: string\n    __MICRO_APP_ENVIRONMENT__: string\n    __MICRO_APP_BASE_ROUTE__: string\n  }\n}\n\n// 与基座的数据交互\nfunction handleMicroData () {\n  // 是否是微前端环境\n  if (window.__MICRO_APP_ENVIRONMENT__) {\n    // 主动获取基座下发的数据\n    console.log('child-react17 getData:', window.microApp.getData());\n\n    // 监听基座下发的数据变化\n    window.microApp.addDataListener((data: Record<string, unknown>) => {\n      console.log('child-react17 addDataListener:', data);\n    })\n\n    // 向基座发送数据\n    setTimeout(() => {\n      window.microApp.dispatch({ myname: 'child-react17' });\n    }, 3000)\n  }\n}\n\n// ----------分割线---默认模式------两种模式任选其一-----放开注释即可运行------- //\n// ReactDOM.render(\n//   <React.StrictMode>\n//     <Router />\n//   </React.StrictMode>,\n//   document.getElementById('react17-root')\n// );\n\n// console.log('微应用child-react17渲染了');\n\n// handleMicroData()\n\n// // 监听卸载操作\n// window.addEventListener('unmount', function () {\n//   ReactDOM.unmountComponentAtNode(document.getElementById('react17-root')!);\n//   console.log('微应用child-react17卸载了');\n// })\n\n// ----------分割线---umd模式------两种模式任选其一-------------- //\n// 将渲染操作放入 mount 函数\nfunction mount () {\n  ReactDOM.render(\n    <React.StrictMode>\n      <Router />\n    </React.StrictMode>,\n    document.getElementById('react17-root')\n  );\n\n  console.log('微应用child-react17渲染了');\n\n  handleMicroData()\n}\n\n// 将卸载操作放入 unmount 函数\nfunction unmount () {\n  ReactDOM.unmountComponentAtNode(document.getElementById('react17-root')!);\n  console.log('微应用child-react17卸载了');\n}\n\n// 微前端环境下，注册mount和unmount方法\nif (window.__MICRO_APP_ENVIRONMENT__) {\n  // @ts-ignore\n  window[`micro-app-${window.__MICRO_APP_NAME__}`] = { mount, unmount }\n} else {\n  // 非微前端环境直接渲染\n  mount();\n}\n"],"sourceRoot":""}